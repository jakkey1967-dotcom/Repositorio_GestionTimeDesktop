<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
  
  <Package Name="GestionTime Desktop"
           Language="1034"
           Version="1.2.0.0"
           Manufacturer="Global Retail Solutions"
           UpgradeCode="F1E2D3C4-B5A6-9780-ABCD-123456789012"
           Scope="perMachine"
           InstallerVersion="500"
           Compressed="yes">

    <Property Id="ARPCONTACT" Value="soporte@gestiontime.com" />
    <Property Id="ARPCOMMENTS" Value="Sistema de gestion de partes de trabajo" />

    <MajorUpgrade DowngradeErrorMessage="Ya tienes una version mas reciente instalada."
                  AllowSameVersionUpgrades="yes"
                  Schedule="afterInstallInitialize" />

    <MediaTemplate EmbedCab="yes" />

    <StandardDirectory Id="ProgramFiles64Folder">
      <Directory Id="INSTALLFOLDER" Name="GestionTime Desktop" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="GestionTime Desktop" />
    </StandardDirectory>

    <Feature Id="MainApplication" 
             Title="GestionTime Desktop" 
             Level="1">
      
      <ComponentGroupRef Id="AllFiles" />
      <ComponentRef Id="AppShortcut" />
      
    </Feature>

    <ui:WixUI Id="WixUI_Minimal" />

  </Package>
  
  <Fragment>
    <ComponentGroup Id="AllFiles" Directory="INSTALLFOLDER">
      <Component>
        <File Source="bin\x64\Debug\net8.0-windows10.0.19041.0\*" />
      </Component>
    </ComponentGroup>
  </Fragment>
  
  <Fragment>
    <Component Id="AppShortcut" Directory="ApplicationProgramsFolder">
      <Shortcut Id="StartMenuShortcut"
                Name="GestionTime Desktop"
                Target="[INSTALLFOLDER]GestionTime.Desktop.exe"
                WorkingDirectory="INSTALLFOLDER" />
      
      <RemoveFolder Id="RemoveMenuFolder" On="uninstall" />
      
      <RegistryValue Root="HKCU" 
                     Key="Software\GestionTime\Desktop" 
                     Name="installed" 
                     Type="integer" 
                     Value="1" 
                     KeyPath="yes" />
    </Component>
  </Fragment>
  
</Wix>
