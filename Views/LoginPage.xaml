<Page
    x:Class="GestionTime.Desktop.Views.LoginPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="Transparent"
    RequestedTheme="Dark">
    
    <Page.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!-- ✅ Solo cargamos LoginPageStyles.xaml (que ya incluye los temas) -->
                <ResourceDictionary Source="Styles/LoginPageStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Page.Resources>

    <!-- // GRID PRINCIPAL RESPONSIVE - Sin tamaños fijos, usa Grid con Row/Column Auto y * -->
    <Grid x:Name="PageRootGrid" Opacity="0">
        <!-- Fondo con imagen dinámica según tema -->
        <Grid.Background>
            <ThemeResource ResourceKey="BackgroundImage"/>
        </Grid.Background>

        <!-- // VISUALSTATEMANAGER - Breakpoints responsive: Small (<720), Medium (>=720), Large (>=1100) -->
        <VisualStateManager.VisualStateGroups>
            <VisualStateGroup x:Name="WindowSizeStates">
                <!-- // Small: <720px - Card centrada, botón tema arriba izquierda -->
                <VisualState x:Name="Small">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="0" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <!-- Card centrada -->
                        <Setter Target="LoginCard.HorizontalAlignment" Value="Center"/>
                        <Setter Target="LoginCard.VerticalAlignment" Value="Center"/>
                        <Setter Target="LoginCard.Margin" Value="20"/>
                        <Setter Target="LoginCard.MaxWidth" Value="360"/>
                        <Setter Target="LoginCard.MinWidth" Value="280"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- // Medium: >=720px - Card a la derecha, márgenes medios -->
                <VisualState x:Name="Medium">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="720" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="LoginCard.HorizontalAlignment" Value="Right"/>
                        <Setter Target="LoginCard.VerticalAlignment" Value="Center"/>
                        <Setter Target="LoginCard.Margin" Value="40"/>
                        <Setter Target="LoginCard.MaxWidth" Value="380"/>
                        <Setter Target="LoginCard.MinWidth" Value="320"/>
                    </VisualState.Setters>
                </VisualState>

                <!-- // Large: >=1100px - Card a la derecha con más margen -->
                <VisualState x:Name="Large">
                    <VisualState.StateTriggers>
                        <AdaptiveTrigger MinWindowWidth="1100" />
                    </VisualState.StateTriggers>
                    <VisualState.Setters>
                        <Setter Target="LoginCard.HorizontalAlignment" Value="Right"/>
                        <Setter Target="LoginCard.VerticalAlignment" Value="Top"/>
                        <Setter Target="LoginCard.Margin" Value="50"/>
                        <Setter Target="LoginCard.MaxWidth" Value="400"/>
                        <Setter Target="LoginCard.MinWidth" Value="340"/>
                    </VisualState.Setters>
                </VisualState>
            </VisualStateGroup>
        </VisualStateManager.VisualStateGroups>

        <!-- // Selector de tema (esquina superior izquierda) -->
        <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Margin="20">
            <Button x:Name="BtnTheme" MinWidth="40" MinHeight="40" CornerRadius="20"
                    Background="{ThemeResource CardBackground}" BorderThickness="1"
                    BorderBrush="{ThemeResource TealPrimary}" ToolTipService.ToolTip="Tema" Padding="8">
                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE700;" FontSize="18"
                          Foreground="{ThemeResource TealPrimary}"/>
                <Button.Flyout>
                    <MenuFlyout>
                        <ToggleMenuFlyoutItem x:Name="ThemeSystemItem" Text="Tema del sistema" Click="OnThemeSystem"/>
                        <ToggleMenuFlyoutItem x:Name="ThemeLightItem" Text="Tema claro" Click="OnThemeLight"/>
                        <ToggleMenuFlyoutItem x:Name="ThemeDarkItem" Text="Tema oscuro" Click="OnThemeDark"/>
                    </MenuFlyout>
                </Button.Flyout>
            </Button>
        </Grid>

        <!-- // Card del formulario -->
        <Border x:Name="LoginCard" CornerRadius="20" Background="{ThemeResource CardBackground}" Padding="24,20">
            <Border.Shadow>
                <ThemeShadow />
            </Border.Shadow>

            <Grid RowSpacing="8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Título -->
                <TextBlock Grid.Row="0" Text="Inicio de Sesión" FontSize="24" FontWeight="Bold"
                           Foreground="{ThemeResource TitleForeground}" HorizontalAlignment="Center"
                           Margin="0,0,0,12" TextWrapping="Wrap"/>

                <!-- Correo electrónico -->
                <Grid Grid.Row="1" RowSpacing="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Correo electrónico" FontSize="12" FontWeight="SemiBold"
                               Foreground="{ThemeResource LabelForeground}"/>
                    
                    <Grid Grid.Row="1">
                        <TextBox x:Name="TxtUser" Style="{StaticResource ModernTextBox}"
                                 PlaceholderText="correo@dominio.com" MinHeight="36" HorizontalAlignment="Stretch"/>
                        <FontIcon HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,10,0"
                                  Glyph="&#xE77B;" FontSize="16" Foreground="{ThemeResource TealPrimary}"/>
                    </Grid>
                </Grid>

                <!-- Contraseña -->
                <Grid Grid.Row="2" RowSpacing="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Contraseña" FontSize="12" FontWeight="SemiBold"
                               Foreground="{ThemeResource LabelForeground}"/>
                    
                    <Grid Grid.Row="1">
                        <PasswordBox x:Name="TxtPass" Style="{StaticResource ModernPasswordBox}"
                                     PlaceholderText="••••••••" MinHeight="36" Visibility="Visible"
                                     KeyDown="OnPasswordKeyDown" HorizontalAlignment="Stretch"/>
                        
                        <TextBox x:Name="TxtPassVisible" Style="{StaticResource ModernTextBox}"
                                 PlaceholderText="••••••••" MinHeight="36" Visibility="Collapsed"
                                 KeyDown="OnPasswordKeyDown" HorizontalAlignment="Stretch"/>
                        
                        <Button x:Name="BtnTogglePassword" HorizontalAlignment="Right" VerticalAlignment="Center"
                                Margin="0,0,8,0" MinWidth="36" MinHeight="36" Background="Transparent"
                                BorderThickness="0" Click="OnTogglePasswordClick"
                                ToolTipService.ToolTip="Mostrar/Ocultar contraseña">
                            <FontIcon x:Name="IconPassword" Glyph="&#xE7B3;" FontSize="16"
                                      Foreground="{ThemeResource TealPrimary}"/>
                        </Button>
                    </Grid>
                </Grid>

                <!-- Botón Iniciar sesión -->
                <Button Grid.Row="3" x:Name="BtnLogin" Style="{StaticResource PrimaryButton}"
                        HorizontalAlignment="Center" Click="OnLoginClick" Margin="0,8,0,0">
                    <Grid ColumnSpacing="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <ProgressRing Grid.Column="0" x:Name="Prg" Width="16" Height="16"
                                      IsActive="False" Visibility="Collapsed" Foreground="White"/>
                        <TextBlock Grid.Column="1" Text="Iniciar sesión" FontSize="15"/>
                    </Grid>
                </Button>

                <!-- Status -->
                <TextBlock Grid.Row="4" x:Name="TxtStatus" Text="" Foreground="{ThemeResource LabelForeground}"
                           FontSize="10" HorizontalAlignment="Center" TextAlignment="Center"
                           Margin="0,4,0,0" Visibility="Collapsed" TextWrapping="Wrap"/>

                <!-- Enlaces -->
                <Grid Grid.Row="5" HorizontalAlignment="Center" Margin="0,4,0,0" RowSpacing="2">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <HyperlinkButton Grid.Row="0" Content="¿Olvidó su contraseña?"
                                     Click="OnForgotPasswordClick" Style="{StaticResource LinkButton}"
                                     HorizontalAlignment="Center" FontSize="11" Padding="0,1"/>
                    <HyperlinkButton Grid.Row="1" Content="Registrarse como nuevo usuario"
                                     x:Name="BtnRegister" Click="OnRegisterClick"
                                     Style="{StaticResource LinkButton}" HorizontalAlignment="Center"
                                     FontWeight="SemiBold" FontSize="11" Padding="0,1"/>
                </Grid>

                <!-- Recordar sesión -->
                <CheckBox Grid.Row="6" x:Name="ChkRemember" Content="Recordar sesión"
                          Foreground="{ThemeResource LabelForeground}" FontSize="10"
                          HorizontalAlignment="Center" Margin="0,2,0,0"/>

                <!-- Ayuda -->
                <HyperlinkButton Grid.Row="7" Content="Ayuda" Foreground="{ThemeResource TealPrimary}"
                                 FontSize="10" HorizontalAlignment="Center" Padding="0,1" Margin="0,2,0,0"/>
            </Grid>
        </Border>
    </Grid>
</Page>

































































































































































